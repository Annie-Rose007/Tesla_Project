---
title: "Tesla Casualties"
author: "Annie-Rose_Grenier"
date: "`r Sys.Date()`"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(ggrepel)
library(skimr)
library(dplyr)
library(forecast)
library(lmtest)
library(broom)
td_csv <- read_csv("td-csv.csv")

```


Fond√©e au d√©but des ann√©es 2000, Tesla a r√©volutionn√© l'industrie automobile en popularisant les v√©hicules √©lectriques hautes performances et la technologie de conduite assist√©e. Cependant, l'entreprise fait face √† une augmentation des questions concernant la s√©curit√© de ses v√©hicules et des probl√®mes de qualit√© per√ßus.

La probl√©matique centrale de cette analyse est de *d√©terminer si les accidents mortels impliquant des v√©hicules Tesla sont principalement dus √† une erreur humaine ou √† des d√©faillances technologiques (robotique)*. Cette question est cruciale, car l'identification pr√©cise des causes permettrait de d√©velopper des mesures pr√©ventives efficaces pour r√©duire le nombre de d√©c√®s.

Pour mener cette √©tude, nous nous appuierons sur une compilation de donn√©es accessible via le site web https://www.tesladeaths.com/. Cette base de donn√©es exhaustive inclut diverses sections, dont celle d√©di√©e aux "Deaths" (D√©c√®s), qui comporte 23 variables pertinentes. Dans le cadre de cette analyse, nous nous concentrerons sur les variables suivantes du fichier csv:

* Year (l‚Äôann√©e de l‚Äôaccident)

* Country (le pays)

* State (l'√âtat)

* Deaths (le compte total des d√©c√®s)

* Tesla driver (d√©c√®s du conducteur)

* Tesla occupant (d√©c√®s des passagers)

* Other vehicle (d√©c√®s des occupants dans une autre voiture)

* Cyclists/ Peds (d√©c√®s de pi√©tons ou cyclistes)

* Model (mod√®le du v√©hicule)

* Verified Tesla Autopilot Death (d√©c√®s confirm√© d√ª √† l‚Äôautopilotage / autopilotage engag√© lors de l‚Äôaccident)

Cette approche m√©thodique, bas√©e sur des donn√©es sp√©cifiques, vise √† apporter un √©clairage objectif sur un enjeu de s√©curit√© publique majeur li√© aux nouvelles technologies automobiles.

```{r dataframe_select, include=FALSE}
#dataframe selectionner
Tesla_casualties <- td_csv %>%
  select(Year, Country, State, Deaths, `Tesla driver`, `Tesla occupant`, `Other vehicle`, `Cyclists/ Peds`, Model, `Verified Tesla Autopilot Death`) %>%


#Remplacer les "-"
  mutate(State = na_if(State, "-"),
         `Tesla driver` = na_if(`Tesla driver`, "-"),
         `Tesla occupant` = na_if(`Tesla occupant`, "-"),
         `Other vehicle` = na_if(`Other vehicle`, "-"),
         `Cyclists/ Peds` = na_if(`Cyclists/ Peds`, "-"), 
         Model = na_if(Model, "-"),
         `Verified Tesla Autopilot Death` = na_if(`Verified Tesla Autopilot Death`, "-")) %>%

#Convertir les colonnes en types numerique
  mutate(across(
    c(`Tesla driver`, `Tesla occupant`, `Other vehicle`, `Cyclists/ Peds`, `Verified Tesla Autopilot Death`), as.numeric)) %>%
  
#Remplacer toutes les valeurs NA, etc par "0"
  mutate(across(
    c(`Tesla driver`, `Tesla occupant`, `Other vehicle`, `Cyclists/ Peds`, `Verified Tesla Autopilot Death`), replace_na, 0))

#Agreger les donnees pour compter chaque mod√®les
Model <- Tesla_casualties %>%
  filter(!is.na(Model), Model != "") %>%
  group_by(Model) %>%
  summarise(Model = n(), .groups = 'drop') %>%
  arrange(desc(Model))
 
  
  
#corriger l'erreur d'annees pour le "case" 431.1
  Tesla_casualties$Year[Tesla_casualties$Year == 431.1] <- 2024
  
#Afficher annees
print(Tesla_casualties %>% filter(Year == 2024))


#(nettoyer, filtrer et agr√©ger)COMMENT RENDRE PLUS SIMPLE mutate(across(c('Tesla driver', etc), .fns = ~as.numeric(na_if(., "-"))))) %>%      replace_na(list('Tesla driver = 0, etc)) %>%



#Afficher les premiere lignes
head(Tesla_casualties)

#Verifier si colonne num√©rique
glimpse(Tesla_casualties)
```

## Model 3 : Victime de son succ√®s ou v√©ritable d√©faut de s√©curit√© ?

Nous nous penchons maintenant sur une interrogation centrale : quel mod√®le de voiture, lorsque l'autopilote est activ√©, est le plus susceptible d'√™tre impliqu√© dans des accidents mortels ? Pour r√©pondre √† cette question, nous posons l'hypoth√®se que le Mod√®le 3, en raison de sa vaste diffusion, serait le plus repr√©sent√© dans ces statistiques.

Afin de v√©rifier la validit√© de cette supposition, nous avons crois√© les donn√©es de mortalit√© avec les mod√®les de v√©hicules sp√©cifiquement impliqu√©s dans des incidents o√π le syst√®me Autopilot √©tait engag√©. Bien que la popularit√© massive d'un mod√®le puisse influencer statistiquement le nombre d'incidents bruts, l'analyse des variables permet de distinguer si un mod√®le particulier se d√©marque par une r√©currence plus √©lev√©e d'accidents technologiques.

Le graphique suivant pr√©sente la r√©partition des d√©c√®s par mod√®le de voiture dans les cas o√π l'Autopilot a √©t√© formellement identifi√© comme √©tant actif ou ayant jou√© un r√¥le au moment de l'impact : 


```{r graph_autopilote_deaths_and_model}
  # Rassembler les colonnes de d√©c√®s sp√©cifiques
Model_verified_autopilot_death <- Tesla_casualties %>%
  
  # Filtrer uniquement les cas o√π l'Autopilot a √©t√© "claimed" (non NA, ou 1)
  filter(`Verified Tesla Autopilot Death` == 1) %>%
  
  # Rassembler les colonnes sp√©cifiques de d√©c√®s
  pivot_longer(
    cols = c(`Tesla driver`, `Tesla occupant`, `Other vehicle`, `Cyclists/ Peds`),
    names_to = "Category",
    values_to = "Deaths_Count"
  ) %>%
  
  # Retirer les lignes o√π le nombre de d√©c√®s est 0 ou NA apr√®s le pivot
  filter(Deaths_Count > 0, !is.na(Model)) %>%
  
  # Agr√©ger le nombre total de d√©c√®s par Cat√©gorie et par Mod√®le de voiture
  group_by(Model, Category) %>%
  summarise(Total_Deaths = sum(Deaths_Count, na.rm = TRUE), .groups = 'drop')

Model_verified_autopilot_death <- ggplot(Model_verified_autopilot_death, aes(x = Category, y = Total_Deaths, fill = Model)) +
  
  # Barres group√©es c√¥te √† c√¥te
  geom_col(position = position_dodge(width = 0.9)) + 
  labs(
    title = "D√©c√®s li√©s √† l'Autopilot par cat√©gorie de victime et mod√®le de voiture",
    x = "Cat√©gorie de victime",
    y = "Nombre total de d√©c√®s",
    
    # L√©gende de remplissage
    fill = "Mod√®le Tesla" 
  ) +
  theme_minimal() + 
  
  # Rotation des √©tiquettes X pour la lisibilit√©
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

# Afficher le graphique
print(Model_verified_autopilot_death)


```

L'analyse des donn√©es pr√©sent√©es dans le graphique "D√©c√®s li√©s √† l'Autopilot par cat√©gorie de victime et mod√®le de voiture" confirme visuellement l'hypoth√®se selon laquelle le Model 3 est le mod√®le de v√©hicule le plus susceptible d'√™tre impliqu√© dans des accidents mortels lorsque l'autopilote est activ√©.

En observant attentivement le graphique, on constate que les barres associ√©es au Model 3 (repr√©sent√©es par la couleur rouge dans les cat√©gories "Tesla driver" et "Other vehicle") sont syst√©matiquement les plus √©lev√©es. Cela indique un nombre absolu de d√©c√®s sup√©rieur pour ce mod√®le par rapport aux Model S, X et Y dans les principales cat√©gories de victimes. Le graphique fournit un d√©compte brut qui valide l'hypoth√®se de l'utilisateur sur la base des fr√©quences absolues d'accidents.

Cependant, il est essentiel de souligner la limite de cette analyse. Le graphique se concentre uniquement sur le nombre total de d√©c√®s et n'inclut aucune donn√©e sur le contexte crucial, comme le volume total de v√©hicules de chaque mod√®le en circulation ou le nombre total de kilom√®tres parcourus avec l'autopilote activ√©. Le Model 3 √©tant le v√©hicule le plus vendu de la gamme, sa pr√©sence accrue sur les routes peut m√©caniquement gonfler les statistiques brutes d'accidents sans n√©cessairement indiquer un taux d'accidents proportionnellement plus √©lev√© par kilom√®tre parcouru. L'analyse visuelle confirme la fr√©quence absolue la plus √©lev√©e pour le Model 3, mais une analyse plus rigoureuse n√©cessiterait des donn√©es d'exposition.

:::: {style="display: flex;"}

::: {style="flex: 1; padding-right: 10px;"}

Le tablaux ci-haut montre le r√©sultat de la r√©gression lin√©aire du graphique "D√©c√®s li√©s √† l'Autopilot par cat√©gorie de victime et mod√®le de voiture". Commen√ßon par expliquer chaque facteurs interessants.

     1. La P-value globale (Le mod√®le est-il utile ?) 

Regardez la toute derni√®re ligne : p-value: 6.798e-06. 

‚Ä¢	Elle est tr√®s inf√©rieure √† 0,05. Cela signifie que le mod√®le est statistiquement significatif : les variables choisies (Year, Mod√®le, Autopilot) ont un impact r√©el sur le nombre de d√©c√®s, ce n'est pas d√ª au hasard. 

     2. Interpr√©tation des Coefficients (L'impact de chaque variable) 

‚Ä¢	Year (0.038790) : La p-value est de 0,00897 (significatif). Cela indique une tendance √† la hausse : chaque ann√©e suppl√©mentaire est associ√©e √† une l√©g√®re augmentation du nombre de d√©c√®s (environ +0,038 par accident r√©pertori√©).

‚Ä¢	Model CYB (0.672110) : La p-value est de 0,02638 (significatif). Le Cybertruck semble associ√© √† un nombre de d√©c√®s par accident plus √©lev√© (+0,67) par rapport au mod√®le de r√©f√©rence (probablement le Model 3, qui n'appara√Æt pas car il sert de base).

‚Ä¢	Model X et Model Y : Leurs p-values sont tr√®s √©lev√©es (0,89 et 0,97). Cela signifie que pour ces mod√®les, il n'y a pas de diff√©rence significative du nombre de d√©c√®s par rapport au mod√®le de r√©f√©rence.

‚Ä¢	Verified Tesla Autopilot Death (1 et 2) : Les deux sont tr√®s significatifs (p < 0,003).

-Le code 1 (Autopilot engag√©) montre curieusement un coefficient n√©gatif (-0,27), sugg√©rant moins de d√©c√®s par accident que lorsque l'info est inconnue.

-Le code 2 montre un coefficient positif fort (+0,70), indiquant une hausse des d√©c√®s dans ces circonstances sp√©cifiques. 

:::

::::{style="flex: 1;"}

```{r regression_graph_autopilote_death_and_model}
#regression lin√©air multiples

#convertir en facteurs variables cat√©gorielles
Tesla_casualties$Model <- as.factor(Tesla_casualties$Model)
Tesla_casualties$`Verified Tesla Autopilot Death` <- as.factor(Tesla_casualties$`Verified Tesla Autopilot Death`)

#convertir en format numerique
Tesla_casualties$Year <- as.numeric(Tesla_casualties$Year)

#regression
Model_predictif <- lm(Deaths~ Year + Model + `Verified Tesla Autopilot Death`, data = Tesla_casualties)

#afficher r√©sultat
summary(Model_predictif)


```
:::

::::

     3. La qualit√© du mod√®le (ùëÖ2)

‚Ä¢	Multiple R2 : 0.1565. Cela signifie que le mod√®le explique environ 15,6 % de la variation du nombre de d√©c√®s. C'est un score relativement faible (proche de 0), ce qui indique que beaucoup d'autres facteurs non inclus dans le code (vitesse, m√©t√©o, type de route) influencent grandement la mortalit√©. 

     4. Les codes de significativit√© (Les √©toiles) 

‚Ä¢	** ou *** : Impact tr√®s fiable.

‚Ä¢	* : Impact fiable.

‚Ä¢	. ou rien : Pas d'impact prouv√© statistiquement.

En r√©sum√©: 

L'analyse par r√©gression montre que l'ann√©e et le mod√®le de v√©hicule (notamment le Cybertruck) influencent significativement le nombre de d√©c√®s. Bien que le mod√®le soit statistiquement valide (ùëù<0,05), il n'explique que 15,6 % de la variance totale, sugg√©rant que d'autres facteurs externes pr√©dominent dans la gravit√© des accidents." 

Attention : Notez que 393 observations ont √©t√© supprim√©es car des donn√©es √©taient manquantes (393 observations effac√©es). Cela peut biaiser les r√©sultats si les donn√©es manquantes ne sont pas al√©atoires.

##  Fronti√®res et collisions : Analyse mondiale et locale des accidents.

Avant m√™me d'examiner le graphique sp√©cifique, il est plausible de supposer que les √âtats-Unis enregistrent le plus grand nombre d'accidents (ou de d√©c√®s) impliquant des v√©hicules Tesla. Cette hypoth√®se repose sur le fait que les √âtats-Unis poss√®dent la plus grande population de conducteurs au monde et, par cons√©quent, le plus grand nombre de v√©hicules et de kilom√®tres parcourus, ce qui augmente statistiquement la probabilit√© d'accidents par rapport √† des pays plus petits comme le Danemark, la Nouvelle-Z√©lande ou la Suisse.


:::: {style="display: flex; align-items: flex-start;"}

::: {style="flex: 80%; padding-right: 20px;"}


```{r graph_deces_pays}
#Totaliser deces par pays
Deaths_per_Country <- Tesla_casualties %>%
  group_by(Country) %>%
  summarise(Total_deaths = sum(Deaths, na.rm = TRUE)) %>%
  

#bonne pratique
  ungroup() %>%

  
#trier pays par deces decroissant
  arrange(desc(Total_deaths))

#Graphique √† barre
ggplot(Deaths_per_Country, aes(x = reorder(Country, -Total_deaths), y = Total_deaths)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(title = "Nombre totale de d√©c√®s par pays (Tesla)",
       x = "Pays",
       y = "D√©c√®s") +
  theme_minimal() +
  
#option si les noms se chevauchent
  theme(axis.text.x = element_text(angle = 45, hjust = 1))



```

En se r√©f√©rant au graphique intitul√© "Nombre totale de d√©c√®s par pays (Tesla)" pr√©sent√© √† l'√©cran, l'hypoth√®se est confirm√©e :
Le graphique indique clairement que les √âtats-Unis (USA) sont le pays avec le plus grand nombre de d√©c√®s enregistr√©s dans le cadre de cette analyse. La barre associ√©e aux √âtats-Unis est significativement plus haute que toutes les autres barres du graphique, dominant visuellement la r√©partition des d√©c√®s par pays (Chine, Allemagne, Canada,etc.).

 Quels sont les √âtats am√©ricains o√π l'Autopilot est le plus mis √† l'√©preuve ? Notre attention se porte sur le Massachusetts. Entre des infrastructures urbaines denses et des habitudes de conduite particuli√®rement nerveuses, cet √âtat constitue un cas d'√©tude id√©al pour savoir si l'IA de Tesla parvient √† s'adapter √† des environnements humains et physiques aussi exigeants.

:::

:::{style="flex: 20%;"}


```{r knitr_Deaths_per_Conutry}
knitr::kable(head(Deaths_per_Country, 20), caption = "Top 20 des d√©c√®s par pays")

```

:::

::::

En se r√©f√©rant au graphique intitul√© "Nombre totale de d√©c√®s par pays (Tesla)" pr√©sent√© √† l'√©cran, l'hypoth√®se est confirm√©e :
Le graphique indique clairement que les √âtats-Unis (USA) sont le pays avec le plus grand nombre de d√©c√®s enregistr√©s dans le cadre de cette analyse. La barre associ√©e aux √âtats-Unis est significativement plus haute que toutes les autres barres du graphique, dominant visuellement la r√©partition des d√©c√®s par pays (Chine,Allemagne, Canada,etc.).

 Quels sont les √âtats am√©ricains o√π l'Autopilot est le plus mis √† l'√©preuve ? Notre attention se porte sur le Massachusetts. Entre des infrastructures urbaines denses et des habitudes de conduite particuli√®rement nerveuses, cet √âtat constitue un cas d'√©tude id√©al pour savoir si l'IA de Tesla parvient √† s'adapter √† des environnements humains et physiques aussi exigeants.

:::: {style="display: flex; align-items: flex-start;"}

::: {style="flex: 60%; padding-right: 20px;"}

```{r graph_deaths_usa_state}
#filtrer donnees pour √âtats-Unis seulement
Deaths_per_state_USA <- Tesla_casualties %>%
  filter(Country == "USA") %>%
  mutate(State = fct_lump_n(State, n = 4, other_level = "Other")) %>%
  group_by(State) %>%
  summarise(Count = n()) %>%
  mutate(Pourcentage = Count / sum(Count) * 100) %>%

  
  #Bonne pratiques
  ungroup()

#creer graph √† barres
ggplot(Deaths_per_state_USA, aes(x = "", y = Count, fill = State)) +
         geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar(theta = "y") +
  scale_fill_brewer(palette = "Green") +
         geom_text(aes(label = paste0(round(Pourcentage, 0), "%")),
                   position = position_stack(vjust = 0.5),
                   color = "black",
                   size = 4,
                   fontface = "bold") +
  theme_void() +
  labs(title = "Nombre d'accidents par √©tat aux √âtats-Unis",
              fill = "√âtats") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"),
        legend.position = "right")

```

:::

::: {style="flex: 40%;"}

L'examen du diagramme circulaire r√©v√®le une r√©partition g√©ographique tr√®s marqu√©e des accidents mortels. La Californie (CA) domine largement avec 38 % des d√©c√®s, suivie de la Floride (FL) √† 12 %, puis de New York (NY) et du Texas (TX) avec 4 % chacun. Les 43 % restants sont fragment√©s entre les 46 autres √âtats am√©ricains.

Ces chiffres confirment la pr√©pond√©rance des √âtats-Unis dans le bilan global, validant une partie de notre hypoth√®se. La concentration massive en Californie et en Floride s'explique logiquement par la densit√© de la flotte Tesla : ces √âtats √©tant les march√©s principaux de la marque, le volume de v√©hicules en circulation y est nettement plus √©lev√©, ce qui augmente m√©caniquement la probabilit√© d'accidents.

Cependant, un point fondamental doit √™tre soulign√© : la grande majorit√© de ces accidents mortels ne sont pas dus √† l'autopilotage. En effet, les donn√©es d√©montrent que le syst√®me d'aide √† la conduite n'√©tait pas activ√© dans la plupart de ces collisions. Cela sugg√®re que le risque d√©pend davantage de facteurs humains ou de l'environnement routier traditionnel que d'une d√©faillance de l'IA.

Enfin, notre hypoth√®se concernant le Massachusetts est infirm√©e. Bien que nous redoutions son infrastructure complexe, cet √âtat ne figure pas parmi les zones les plus touch√©es, prouvant que le volume total de kilom√®tres parcourus par la flotte reste le facteur pr√©dictif le plus fiable, bien avant le temp√©rament des conducteurs locaux.

:::

::::

```{r knitr_Deaths_usa_state}
knitr::kable(Deaths_per_state_USA)

```


## Tesla Deaths : Le verdict des donn√©es entre IA et erreur humaine






:::: {style="display: flex; align-items: flex-start;"}

::: {style="flex: 60%; padding-right: 20px;"}


```{r graph_deces_annees}
#totaliser les d√©c√®s par ann√©es
Deaths_per_year <- Tesla_casualties %>%
  group_by(Year) %>%
  summarise(Total_deaths = sum(Deaths, na.rm = TRUE))


#Graphique
ggplot(data = Deaths_per_year, aes(x = Year, y = Total_deaths)) +
  geom_line(color = "red", linewidth = 1) +
  geom_point(color = "red", size = 3) +
  labs(title = "Nombre de d√©c√®s par an",
              x = "Ann√©es",
              y = "Nombre total de d√©c√®s") +
  theme_minimal()

```

:::

::: {style="flex: 40%;"}


```{r knitr_Deaths_per_year}
knitr::kable(Deaths_per_year)

```

:::

::::
